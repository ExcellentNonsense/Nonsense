"use strict";document.addEventListener("DOMContentLoaded",()=>{band.startTimer(),band.bindEventHandlers(),band.switchOnReminder(),band.fillBand()});let band={};(function(){function e(e){let t=document.querySelector(".js-page-overlay__active-suggestion"),n=document.querySelectorAll(".js-page-overlay__suggestion")[e],o=document.querySelector(".js-page-overlay");if(null!==t&&t.classList.remove("js-page-overlay__active-suggestion"),n.classList.add("js-page-overlay__active-suggestion"),o.style.opacity="1",o.style.display="block",2===e){document.querySelector(".js-page-overlay__btn-hide-overlay").style.display="none"}}function t(){let e=document.querySelectorAll(".js-page-overlay__active-suggestion .js-page-overlay__suggestion-row");e[0].classList.add("js-page-overlay__suggestion-row--hide-row1"),e[1].classList.add("js-page-overlay__suggestion-row--hide-row2"),e[2].classList.add("js-page-overlay__suggestion-row--hide-row3");let t=document.querySelector(".js-page-overlay");t.style.opacity="0",setTimeout(()=>{t.style.display="none"},900)}this.bindEventHandlers=(()=>{window.addEventListener("scroll",()=>{window.pageYOffset+document.documentElement.clientHeight>=document.documentElement.scrollHeight&&this.fillBand()}),document.querySelector(".js-page-overlay__btn-hide-overlay").addEventListener("click",t)}),this.startTimer=(()=>{const e=121,t=setInterval(function(){let t=document.querySelector(".js-logged-in-user__spent-time");n+=e,t.textContent=function(e){if(e>=1){let t=e,n=0,o=0;if(e>999){let a=(e-(t=e%1e3))/1e3;a>59?o=(a-(n=a%60))/60:n=a}return(o=0===o?"00":o<10?"0"+o:o)+":"+(n=0===n?"00":n<10?"0"+n:n)+":"+(t=0===t?"000":t<10?"00"+t:t<100?"0"+t:t)}return"00:00:000"}(n)},e);setTimeout(()=>{clearInterval(t)},36e5);let n=0}),this.switchOnReminder=(()=>{setTimeout(e,12e5,0),setTimeout(e,24e5,1),setTimeout(e,36e5,2)}),this.fillBand=(()=>{switch(document.querySelector(".js-band-item-template").getAttribute("data-band-type")){case"my-band":break;case"flickr-band":!function(){band.toggleDataLoadingNotification(),utils.getJSON("/Band/GetFlickrImages",function(e){let t=document.querySelector(".js-band-items-container");if("ok"===e.stat){let n=document.querySelector(".js-band-item-template");e.images.forEach(e=>{if(null!==e.url_z){let o=document.importNode(n.content,!0),a=o.querySelector(".js-band-item__image-source-info"),i=document.createElement("a");i.href="https://www.flickr.com/photos/"+e.owner+"/"+e.id,i.target="_blank",i.textContent=e.title,a.appendChild(i);let s=o.querySelector(".js-band-item__image");s.src=e.url_z,t.appendChild(o)}})}else band.showDataLoadingError();band.toggleDataLoadingNotification()})}()}}),this.toggleDataLoadingNotification=(()=>{let e=document.querySelector(".js-data-loading-notification");e.classList.toggle("js-data-loading-notification--hidden"),e.querySelectorAll(".js-data-loading-notification__drop").forEach(e=>{e.classList.toggle("js-data-loading-notification__drop--animated")}),e.querySelectorAll(".js-data-loading-notification__message-part").forEach(e=>{e.classList.toggle("js-data-loading-notification__message-part--animated")})}),this.showDataLoadingError=(()=>{let e=document.querySelector(".js-band-items-container"),t=e.querySelector(".js-band-loading-images-error");null!==t&&e.removeChild(t);let n=document.createElement("p");n.className="js-band-loading-images-error",n.style.textAlign="center",n.textContent="Сервис недоступен. Попробуйте обновить страницу.";let o=document.createElement("pre");o.textContent+="_\r\n",o.textContent+="_/*\\_\r\n",o.textContent+="/_____\\\r\n",o.textContent+="| %,% |\r\n",o.textContent+="\\ (-) /\r\n",o.textContent+="\\_'_/\r\n",n.appendChild(o),utils.insertAfter(n,e)})}).apply(band),document.addEventListener("DOMContentLoaded",()=>{global.bindEventHandlers()});let global={};(function(){this.bindEventHandlers=(()=>{document.querySelector(".js-btn-scroll-to-top").addEventListener("click",()=>window.scrollTo(window.pageXOffset,0))})}).apply(global);let utils={};(function(){this.getJSON=((e,t)=>{let n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=(()=>{if(4===n.readyState&&200===n.status){n.getResponseHeader("Content-Type").match(/application\/json/)&&t(JSON.parse(n.responseText))}}),n.send()}),this.insertAfter=((e,t)=>{t.parentNode.insertBefore(e,t.nextSibling)})}).apply(utils);